!function(){var t=function(t,o){this.$div=$(t),this._options=o};t.prototype.render=function(){var t=this.$div.addClass("photo-rotator").html(['<p class="photo-rotator-image" ><a href="#" ><img /></a></p>','<p class="photo-rotator-title" ><a href="#" ></a></p>'].join("\n")),o=t.children(".photo-rotator-image"),e=o.children(),i=e.children(),l=t.find(".photo-rotator-title a"),d=e.add(l),n=this._options,s=o.width(),h=s*(4/3);o.height(h),o.css("lineHeight",h+"px"),d.hide(),$.getJSON("//photo.xuite.net/_feed/photo?user_id="+n.userID+"&album_id="+n.albumID+"&count=500&callback=?",function(o){if(o.error)t[0].style.backgroundColor="#000000",t[0].childNodes[0].innerHTML="讀取錯誤",t[0].childNodes[0].style.color="#FFFFFF",t[0].childNodes[0].style.fontSize="20px",t[0].childNodes[0].style.textAlign="center",t[0].childNodes[0].style.fontWeight="bold";else if(o.photos&&o.photos.length>0){var n=o.photos,r=n.length,c=0;!function t(){c===r&&(c=0);var o=n[c],a=new Image;a.onload=function(){var n,r,a=this.width,f=this.height;f/a>4/3?(r=h,n=a*h/f):(n=s,r=f*s/a),i.width(n).height(r).attr("src",this.src);var p=o.link;e.attr("href",p),l.attr("href",p).html(o.title),d.fadeIn().promise().done(function(){++c,setTimeout(function(){d.fadeOut().promise().done(function(){t()})},3e3)})},a.src=o.media.m}()}else t[0].style.backgroundColor="#000000",t[0].childNodes[0].innerHTML="沒有相片",t[0].childNodes[0].style.color="#FFFFFF",t[0].childNodes[0].style.fontSize="20px",t[0].childNodes[0].style.textAlign="center",t[0].childNodes[0].style.fontWeight="bold"}).error(function(){t[0].style.backgroundColor="#000000",t[0].childNodes[0].innerHTML="讀取錯誤",t[0].childNodes[0].style.color="#FFFFFF",t[0].childNodes[0].style.fontSize="20px",t[0].childNodes[0].style.textAlign="center",t[0].childNodes[0].style.fontWeight="bold"})},XUI.Widgets.PhotoRotator=t}();